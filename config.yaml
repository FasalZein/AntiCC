# CLIProxyAPI Configuration for Claude Code with Antigravity
# This configuration enables Claude Code to use Antigravity models (Claude, Gemini, GPT via Google)
#
# Available Antigravity Models (with gemini- prefix):
#   - gemini-claude-opus-4-5-thinking (Claude Opus 4.5 with extended thinking)
#   - gemini-claude-sonnet-4-5 (Claude Sonnet 4.5)
#   - gemini-claude-sonnet-4-5-thinking (Claude Sonnet 4.5 with extended thinking)
#   - gemini-3-pro-preview (Gemini 3 Pro)
#   - gemini-2.5-flash (Gemini 2.5 Flash)
#   - gemini-2.5-flash-lite (Gemini 2.5 Flash Lite)
#   - gpt-oss-120b-medium (GPT-OSS 120B)

# Server Configuration
port: 8317
debug: false
logging-to-file: true
# request-log: true

# Authentication directory for storing OAuth tokens
# Tokens are saved as: ~/.cli-proxy-api/antigravity-<email>.json
auth-dir: "~/.cli-proxy-api"

# API Keys for client authentication (optional but recommended)
# These keys are used by clients (like Claude Code) to authenticate with CLIProxyAPI
api-keys:
  - "sk-046ad23dfe424a369795433c1c9e0cc4f35a7d318c4e1716"

# Request retry on failure (useful for rate limit handling)
request-retry: 3

# Quota exceeded behavior - automatically switch accounts/models when rate limited
quota-exceeded:
  switch-project: true
  switch-preview-model: true

# ============================================================================
# MODEL MAPPINGS FOR CLAUDE CODE
# ============================================================================
# Claude Code's internal agents (like Claude-Mem) use hardcoded model names
# that don't match Antigravity's model names. These mappings redirect those
# requests to the correct Antigravity models.
#
# How it works:
# - Claude Code sends "claude-sonnet-4-5" in some internal requests
# - CLIProxyAPI intercepts and maps it to "gemini-claude-sonnet-4-5-thinking"
# - force-model-mappings: true ensures mappings ALWAYS apply
#
# NOTE: Even though this is under "ampcode:", it works for ALL requests
# going through CLIProxyAPI, not just AmpCode requests.
ampcode:
  force-model-mappings: true
  model-mappings:
    # Claude Opus models -> Antigravity Claude Opus (thinking)
    - from: claude-opus-4-5-20251101
      to: gemini-claude-opus-4-5-thinking
    - from: claude-opus-4-5
      to: gemini-claude-opus-4-5-thinking
    - from: claude-opus-4-1-20250805
      to: gemini-claude-opus-4-5-thinking
    - from: claude-opus-4-20250514
      to: gemini-claude-opus-4-5-thinking
    
    # Claude Sonnet models -> Antigravity Claude Sonnet (thinking)
    - from: claude-sonnet-4-5-20250929
      to: gemini-claude-sonnet-4-5-thinking
    - from: claude-sonnet-4-5
      to: gemini-claude-sonnet-4-5-thinking
    - from: claude-sonnet-4-20250514
      to: gemini-claude-sonnet-4-5-thinking
    - from: claude-3-7-sonnet-20250219
      to: gemini-claude-sonnet-4-5-thinking
    
    # Claude Haiku models -> Antigravity Claude Sonnet (regular, faster)
    - from: claude-haiku-4-5-20251001
      to: gemini-claude-sonnet-4-5
    - from: claude-3-5-haiku-20241022
      to: gemini-claude-sonnet-4-5

# ============================================================================
# ACCOUNT ROTATION EXPLAINED:
# ============================================================================
# CLIProxyAPI uses round-robin load balancing for multiple accounts:
#
# 1. When you run `CLIProxyAPI --antigravity-login` multiple times with different
#    Google accounts, each account is saved to ~/.cli-proxy-api/antigravity-<email>.json
#
# 2. On each request, CLIProxyAPI rotates through available accounts
#
# 3. If an account hits rate limits:
#    - It's marked as rate-limited with a reset time
#    - Requests automatically route to the next available account
#    - The rate-limited account is skipped until the reset time passes
#
# 4. The `request-retry: 3` setting means failed requests will retry up to 3 times
#    with different accounts before returning an error
#
# Your existing accounts from /Users/tothemoon/.config/opencode/antigravity-accounts.json
# need to be re-authenticated via CLIProxyAPI's OAuth flow to work with this proxy.
# ============================================================================

# Remote management (optional - for web-based control panel)
remote-management:
  allow-remote: false
  secret-key: ""
  disable-control-panel: true

# Usage statistics (optional)
usage-statistics-enabled: false